#!/usr/bin/env bash

function fmt() {
    local attrs=''
    while (( $# > 3 )); do
        local attr=''
        case "${1}" in
            bold) attr=1;;
            italic) attr=3;;
            underline) attr=4;;
        esac
        attrs="${attr};${attrs}"
        shift
    done
    local fgcolor="$(toFgCode "${1}")"
    local bgcolor="$(toBgCode "${2}")"
    local text="${3}"
    printf "\e[${attrs}${fgcolor};${bgcolor}m${text}\e[0m"
}


function toFgCode() {
    local x="${1}"
    if (( ${1} < 8 )); then x="$(( ${1} + 30 ))"; else x="$(( ${1} + 82 ))"; fi
    printf "${x}"
}


function toBgCode() {
    printf "$(( $(toFgCode ${1}) + 10 ))"
}


function fragment() {
    local space='  '
    local fgcolor="$(printf "%s%s" "${space:${#1}}" "${1}")"
    local bgcolor="$(printf "%s%s" "${space:${#2}}" "${2}")"
    fmt "${fgcolor}" "${fgcolor}" "    "
    fmt "${fgcolor}" "${bgcolor}" " Color ${fgcolor} on ${bgcolor}  "
    fmt 'bold' "${fgcolor}" "${bgcolor}" "  Color ${fgcolor} on ${bgcolor}   "
}


for bgcolor in 15 0; do
    for fgcolor in {0..7}; do
        printf "$(fragment "${fgcolor}" "${bgcolor}")$(fragment "$(( ${fgcolor} + 8 ))" "${bgcolor}")\n"
    done
done

